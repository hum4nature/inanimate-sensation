import{r,j as s}from"./jsx-runtime-BmCkTyBI.js";import{H as P,h as v,n as M,P as O,b as $,g as H}from"./useUiStateStore-BTW2eq2x.js";import{G as E,x as F,g as L,N as R,f as U,a as G,w as V,h as k}from"./input-CP8d1LBk.js";const q=({className:w,selectableCategories:c,selectableSubCategories:m,category:i,subCategory:d,isSubCategory:n,enableUnselect:p,onCategorySelect:N,onSubCategorySelect:f})=>{const{t:o}=P(),[j,C]=r.useState(!1),t=r.useMemo(()=>v.find(e=>e.name===i),[i]),h=r.useMemo(()=>{let e=[];if(n){if(t&&(e=t.subCategories.map(a=>({selectable:!m||(m==null?void 0:m.some(l=>l.name===a.name)),t:o(`categories.${a.name}`),...a})).sort((a,l)=>a.selectable&&l.selectable?0:!a.selectable&&!l.selectable?a.name.localeCompare(l.name):a.selectable&&!l.selectable?-1:1)),p!==!0){const a=c==null?void 0:c.find(l=>l.name===i);if(t!=null&&t.disablePosting||!(a!=null&&a.subcategoryUnselectable))return e}}else e=v.map(a=>({selectable:!c||(c==null?void 0:c.some(l=>l.name===a.name)),t:o(`categories.${a.name}`),...a})).sort((a,l)=>a.selectable&&l.selectable||!a.selectable&&!l.selectable?a.name.localeCompare(l.name):a.selectable&&!l.selectable?-1:1);return e.unshift({id:"d6e950cc-7136-43d3-829e-06648c571263",name:"...",tags:[],icon:"",t:"...",selectable:!0}),e},[n,t,p,m,o,c,i]),x=n?d:i,g=r.useMemo(()=>n?t==null?void 0:t.subCategories.find(e=>e.name===d):t,[t,n,d]),S=e=>{(n?e===d:e===i)||(n?f(e):(N(e),f(null)))},[b,y]=r.useState(""),u=r.useMemo(()=>b?h.map(e=>({option:e,score:E(e.t.toLowerCase(),b,[])})).filter(e=>e.score>0).sort((e,a)=>a.score-e.score).map(e=>e.option):h,[h,b]);return n&&(!t||!t.subCategories.length)?null:s.jsx("div",{className:M(w),children:s.jsxs(O,{open:j,onOpenChange:C,children:[s.jsx($,{asChild:!0,children:s.jsx(F,{comboboxOpen:j,children:x?s.jsxs("div",{className:"flex flex-row gap-2",children:[g&&s.jsx("img",{className:"min-w-5",width:20,height:20,src:g.icon,alt:g.name}),s.jsx("div",{className:"truncate",children:o(`categories.${x}`)})]}):s.jsx(s.Fragment,{children:o(n?"label.selectSubCategoryPh":"label.selectCategoryPh")})})}),s.jsx(H,{sideOffset:5,className:"p-0 max-h-[var(--radix-popover-content-available-height)] w-[var(--radix-popover-trigger-width)] min-w-[150px] max-w-[var(--radix-popover-content-available-width)] overflow-hidden",children:s.jsxs(L,{shouldFilter:!1,children:[s.jsx(R,{value:b,onValueChange:e=>{y(e)},placeholder:o("label.searchPh")}),s.jsx(U,{children:s.jsx(G,{children:u==null?void 0:u.map(e=>s.jsx(V,{value:e.name,disabled:!e.selectable,onSelect:a=>{C(!1),S(a!=="..."?a:null)},selected:e.name===x,children:e.name==="..."?s.jsx("div",{children:e.name}):s.jsxs("div",{className:"flex flex-row gap-2",children:[s.jsx("img",{className:"min-w-5",width:20,height:20,src:e.icon,alt:e.name}),s.jsx("div",{className:"truncate",children:e.t})]})},e.name))})}),s.jsx(k,{children:o("label.noResults")})]})})]})})},D=r.memo(q);export{D as t};
